
<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../../../">
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Fluent &mdash; Sheffield HPC Documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../../_static/pygments.css?v=fa44fd50" />
      <link rel="stylesheet" type="text/css" href="../../../../_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="../../../../_static/copybutton.css?v=76b2166b" />
      <link rel="stylesheet" type="text/css" href="../../../../_static/tabs.css?v=a5c4661c" />
      <link rel="stylesheet" type="text/css" href="../../../../_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css?v=0a3b3ea7" />
      <link rel="stylesheet" type="text/css" href="../../../../_static/css/custom.css?v=0a35405e" />

  
    <link rel="canonical" href="https://docs.hpc.shef.ac.uk/stanage/software/apps/ansys/fluent.html" />
  <!--[if lt IE 9]>
    <script src="../../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../../../_static/jquery.js?v=5d32c60e"></script>
        <script src="../../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../../../../_static/documentation_options.js?v=5929fcd5"></script>
        <script src="../../../../_static/doctools.js?v=9a2dae69"></script>
        <script src="../../../../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script src="../../../../_static/clipboard.min.js?v=a7894cd8"></script>
        <script src="../../../../_static/copybutton.js?v=f281be69"></script>
        <script src="../../../../_static/design-tabs.js?v=36754332"></script>
    <script src="../../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
    <link rel="next" title="Mechanical / MAPDL" href="mechanical.html" />
    <link rel="prev" title="ANSYS" href="index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../../index.html" class="icon icon-home">
            Sheffield HPC Documentation
              <img src="../../../../_static/UOSLogo_Primary_Violet_RGB_small.png" class="logo" alt="Logo"/>
          </a><div>
    <h3>Quick search</h3>
    <!--Setup by JKWM via https://cse.google.com/cse/all-->
    <script async src="https://cse.google.com/cse.js?cx=243e6cd4be08b404b">
    </script>
    <div class="gcse-search"></div>
 </div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../../hpc/index.html">Using the HPC Systems</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../../index.html">Stanage</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../../stanage-FAQ-gotchas.html">Stanage FAQ and Gotchas</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../../index.html">Software on Stanage</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="../index.html">Applications on Stanage</a><ul class="current">
<li class="toctree-l4 current"><a class="reference internal" href="index.html">ANSYS</a><ul class="current">
<li class="toctree-l5"><a class="reference internal" href="index.html#module-loading">Module loading</a></li>
<li class="toctree-l5 current"><a class="reference internal" href="index.html#ansys-programs">ANSYS Programs</a><ul class="current">
<li class="toctree-l6 current"><a class="current reference internal" href="#">Fluent</a></li>
<li class="toctree-l6"><a class="reference internal" href="mechanical.html">Mechanical / MAPDL</a></li>
<li class="toctree-l6"><a class="reference internal" href="ls-dyna.html">ANSYS LS-DYNA</a></li>
</ul>
</li>
<li class="toctree-l5"><a class="reference internal" href="index.html#ansys-training-and-help-resources">ANSYS training and help resources</a></li>
<li class="toctree-l5"><a class="reference internal" href="index.html#ansys-example-models">ANSYS example models</a></li>
<li class="toctree-l5"><a class="reference internal" href="index.html#installation-note-for-administrators">Installation note for Administrators:</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../R.html">R</a></li>
<li class="toctree-l4"><a class="reference internal" href="../abaqus.html">Abaqus</a></li>
<li class="toctree-l4"><a class="reference internal" href="../ansysem.html">ANSYSEM</a></li>
<li class="toctree-l4"><a class="reference internal" href="../apptainer.html">Apptainer/Singularity</a></li>
<li class="toctree-l4"><a class="reference internal" href="../castep.html">CASTEP</a></li>
<li class="toctree-l4"><a class="reference internal" href="../git-lfs.html">Git LFS</a></li>
<li class="toctree-l4"><a class="reference internal" href="../gmp.html">GnuMP</a></li>
<li class="toctree-l4"><a class="reference internal" href="../gromacs.html">GROMACS</a></li>
<li class="toctree-l4"><a class="reference internal" href="../java.html">Java (Temurin/OpenJDK)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../julia.html">Julia</a></li>
<li class="toctree-l4"><a class="reference internal" href="../lammps.html">LAMMPS</a></li>
<li class="toctree-l4"><a class="reference internal" href="../mathematica.html">Mathematica</a></li>
<li class="toctree-l4"><a class="reference internal" href="../matlab.html">MATLAB</a></li>
<li class="toctree-l4"><a class="reference internal" href="../maven.html">Maven</a></li>
<li class="toctree-l4"><a class="reference internal" href="../molpro.html">Molpro</a></li>
<li class="toctree-l4"><a class="reference internal" href="../ncdu.html">ncdu</a></li>
<li class="toctree-l4"><a class="reference internal" href="../netlogo.html">NetLogo</a></li>
<li class="toctree-l4"><a class="reference internal" href="../nextflow.html">Nextflow</a></li>
<li class="toctree-l4"><a class="reference internal" href="../openfoam.html">OpenFOAM</a></li>
<li class="toctree-l4"><a class="reference internal" href="../python.html">Python</a></li>
<li class="toctree-l4"><a class="reference internal" href="../pytorch.html">PyTorch</a></li>
<li class="toctree-l4"><a class="reference internal" href="../rosetta.html">Rosetta</a></li>
<li class="toctree-l4"><a class="reference internal" href="../rstudio.html">RStudio</a></li>
<li class="toctree-l4"><a class="reference internal" href="../sox.html">SoX</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tensorflow.html">TensorFlow</a></li>
<li class="toctree-l4"><a class="reference internal" href="../vasp.html">VASP</a></li>
<li class="toctree-l4"><a class="reference internal" href="../xvfb.html">Xvfb</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../development/index.html">Developing on Stanage</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../libs/index.html">Libraries on Stanage</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../parallel/index.html">Parallel Systems on Stanage</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../stubs/index.html">All Packages Index</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../cluster_specs.html">Stanage Specifications</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../slurm.html">Slurm Scheduler Job Submission info</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../stanage-mfa-setup.html">Stanage TOTP multifactor authentication setup</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../GPUComputingStanage.html">Using GPUs on Stanage</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../../bessemer/index.html">Bessemer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../parallel/index.html">Parallel Computing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../newsletter/index.html">News</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../glossary.html">Glossary of Terms</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../other-uk-hpc-resources.html">Access to External UK HPC Facilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../help.html">Need help?</a></li>
<li class="toctree-l1"><a class="reference external" href="https://rcgsheffield.github.io/TUoS-RIT-training-resources/training.html">Courses / Training Index</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../FAQs.html">Frequently Asked Questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../cheatsheets/index.html">Quick Reference (Cheat Sheets)</a></li>
<li class="toctree-l1"><a class="reference external" href="http://changelog.hpc.shef.ac.uk/">Latest Software / HPC changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../referenceinfo/index.html">Reference Information Index</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../citing.html">Suggested text for citations and letters of support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../decommissioned/index.html">Decommissioned Clusters</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../index.html">Sheffield HPC Documentation</a>
      </nav>

      <div class="wy-nav-content">
<!-- <a class="forkme" href="https://github.com/rcgsheffield/sheffield_hpc">
<img alt="Fork me on GitHub" src="../../../../_static/img/forkme.png"> 
</a> -->

        <div class="rst-content style-external-links">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../../index.html">Stanage</a></li>
          <li class="breadcrumb-item"><a href="../../index.html">Software on Stanage</a></li>
          <li class="breadcrumb-item"><a href="../index.html">Applications on Stanage</a></li>
          <li class="breadcrumb-item"><a href="index.html">ANSYS</a></li>
      <li class="breadcrumb-item active">Fluent</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <span class="target" id="ansys-stanage-fluent"></span><aside class="sidebar" id="ansys-stanage-sidebar">
<p class="sidebar-title">ANSYS</p>
<dl class="field-list simple">
<dt class="field-odd">Versions<span class="colon">:</span></dt>
<dd class="field-odd"><p>19.2, 2022R2, 2023R1, 2023R2</p>
</dd>
<dt class="field-even">Dependencies<span class="colon">:</span></dt>
<dd class="field-even"><p>UDFs / User subroutines will also need either the GCC or Intel C compiler with correct versions.</p>
</dd>
<dt class="field-odd">URL<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="http://www.ansys.com">http://www.ansys.com</a></p>
</dd>
</dl>
</aside>
<section id="fluent">
<h1><a class="toc-backref" href="#id1" role="doc-backlink">Fluent</a><a class="headerlink" href="#fluent" title="Link to this heading"></a></h1>
<nav class="contents" id="contents">
<p class="topic-title">Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#fluent" id="id1">Fluent</a></p>
<ul>
<li><p><a class="reference internal" href="#module-loading" id="id2">Module loading</a></p></li>
<li><p><a class="reference internal" href="#interactive-jobs" id="id3">Interactive jobs</a></p></li>
<li><p><a class="reference internal" href="#batch-jobs" id="id4">Batch jobs</a></p>
<ul>
<li><p><a class="reference internal" href="#fluent-journal-files" id="id5">Fluent Journal files</a></p></li>
<li><p><a class="reference internal" href="#batch-submission-script" id="id6">Batch Submission Script</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#exporting-gui-fluent-plots-in-batch-submission-jobs" id="id7">Exporting GUI Fluent plots in batch submission jobs</a></p>
<ul>
<li><p><a class="reference internal" href="#sources" id="id8">Sources</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#ansys-fluent-training-and-help-resources" id="id9">ANSYS Fluent training and help resources</a></p></li>
</ul>
</li>
</ul>
</nav>
<hr class="docutils" />
<p>ANSYS Fluent is a Computational Fluid Dynamics (CFD) code for modelling fluid flow, heat transfer, mass transfer and chemical reactions.
Fluent has interfaces to other pre and post processing packages supplied by ANSYS such as ICEMCFD or Ensight and can incorporate user developed models via user defined functions.
Fluent can make use of  built in <a class="reference internal" href="../../../../parallel/MPI.html#parallel-mpi"><span class="std std-ref">MPI</span></a> to utilize multiple cross node CPU and can scale to hundreds of cores.</p>
<div class="admonition caution">
<p class="admonition-title">Caution</p>
<p>ANSYS users can now use a maximum of 400 concurrent cores, across all devices on campus, including personal machines and HPC clusters,
and regardless of the number of ANSYS applications they have open. Please see <a class="reference internal" href="../../../../FAQs.html#ansys-license-restrictions"><span class="std std-ref">ANSYS license restrictions</span></a> for more detail.</p>
</div>
<hr class="docutils" />
<section id="module-loading">
<h2><a class="toc-backref" href="#id2" role="doc-backlink">Module loading</a><a class="headerlink" href="#module-loading" title="Link to this heading"></a></h2>
<p>After connecting to Stanage (see <a class="reference internal" href="../../../../hpc/connecting.html#ssh"><span class="std std-ref">Establishing a SSH connection</span></a>),  you can start an <a class="reference internal" href="../../../../hpc/scheduler/index.html#submit-interactive-stanage"><span class="std std-ref">interactive session</span></a> or submit a batch job using ANSYS programs activating them and making them available with one of the module load commands below:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">module</span> <span class="n">load</span> <span class="n">ANSYS</span><span class="o">/</span><span class="mf">19.2</span>
<span class="n">module</span> <span class="n">load</span> <span class="n">ANSYS</span><span class="o">/</span><span class="mi">2022</span><span class="n">R2</span>
<span class="n">module</span> <span class="n">load</span> <span class="n">ANSYS</span><span class="o">/</span><span class="mi">2023</span><span class="n">R1</span>
<span class="n">module</span> <span class="n">load</span> <span class="n">ANSYS</span><span class="o">/</span><span class="mi">2023</span><span class="n">R2</span>
</pre></div>
</div>
</section>
<hr class="docutils" />
<section id="interactive-jobs">
<h2><a class="toc-backref" href="#id3" role="doc-backlink">Interactive jobs</a><a class="headerlink" href="#interactive-jobs" title="Link to this heading"></a></h2>
<p>After connecting to Stanage (see <a class="reference internal" href="../../../../hpc/connecting.html#ssh"><span class="std std-ref">Establishing a SSH connection</span></a>),  start an interactive session with the following command:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>srun<span class="w"> </span>--pty<span class="w"> </span>bash<span class="w"> </span>-i
</pre></div>
</div>
<p>If desired, the ANSYS Workbench GUI executable can be launched with the  <code class="docutils literal notranslate"><span class="pre">runwb2</span></code> command.
To use more than a single core, you should write a batch job script and fluent journal file for submission to the batch queues.</p>
</section>
<hr class="docutils" />
<section id="batch-jobs">
<h2><a class="toc-backref" href="#id4" role="doc-backlink">Batch jobs</a><a class="headerlink" href="#batch-jobs" title="Link to this heading"></a></h2>
<p>To submit Fluent jobs with larger resources a batch job must be submitted to the scheduler.
A Fluent batch job is composed of a Fluent journal file which tells Fluent what to do and submission script which tells the scheduler how much resource to request and how to start Fluent.</p>
<section id="fluent-journal-files">
<h3><a class="toc-backref" href="#id5" role="doc-backlink">Fluent Journal files</a><a class="headerlink" href="#fluent-journal-files" title="Link to this heading"></a></h3>
<p>A Fluent journal file is effectively a sequence of TUI and/or Scheme commands that you’ll supply to Fluent instead of using the GUI / TUI.
A more thorough explanation and tutorial on how to make a Fluent journal file can be found on the following page:  <a class="reference internal" href="../../../../referenceinfo/ANSYS/fluent/writing-fluent-journal-files.html#writing-fluent-journal-files"><span class="std std-ref">Writing Fluent journal files.</span></a></p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>It is critical that you consult with the <a class="reference internal" href="../../../../referenceinfo/ANSYS/fluent/writing-fluent-journal-files.html#writing-fluent-journal-files"><span class="std std-ref">Fluent journal syntax</span></a> documentation linked above in order to ensure features such as autosaving and intermediate save states are turned on and functioning correctly!</p>
</div>
</section>
<section id="batch-submission-script">
<h3><a class="toc-backref" href="#id6" role="doc-backlink">Batch Submission Script</a><a class="headerlink" href="#batch-submission-script" title="Link to this heading"></a></h3>
<p>On Stanage, Fluent jobs can either be run on just one node (SMP) or across multiple nodes, (but will use its in-built MPI communications for both).</p>
<section id="sample-smp-fluent-scheduler-job-script">
<h4>Sample SMP Fluent Scheduler Job Script<a class="headerlink" href="#sample-smp-fluent-scheduler-job-script" title="Link to this heading"></a></h4>
<p>The following is an example batch submission script, <code class="docutils literal notranslate"><span class="pre">cfd_job.sh</span></code>, to run the executable <code class="docutils literal notranslate"><span class="pre">fluent</span></code> with input journal file <code class="docutils literal notranslate"><span class="pre">test.jou</span></code>, and carry out a 2D double precision CFD simulation.
The script requests 4 cores with a runtime of 60 mins and 8 GB of real memory per node.</p>
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<ul class="simple">
<li><p>The <code class="docutils literal notranslate"><span class="pre">2ddp</span></code> argument is used to specify a 2D double precision simulation. Valid values include: <code class="docutils literal notranslate"><span class="pre">2d</span></code>, <code class="docutils literal notranslate"><span class="pre">2ddp</span></code>, <code class="docutils literal notranslate"><span class="pre">3d</span></code> and <code class="docutils literal notranslate"><span class="pre">3ddp</span></code>.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">#SBATCH</span> <span class="pre">--nodes=1</span></code> asks the scheduler for 1 node.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">#SBATCH</span> <span class="pre">--ntasks-per-node=1</span></code> asks the scheduler for 1 task per node.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">#SBATCH</span> <span class="pre">--cpus-per-task=4</span></code> asks the scheduler for 4 cores in the single task.</p></li>
<li><p>The arguments <code class="docutils literal notranslate"><span class="pre">-gu</span></code> and <code class="docutils literal notranslate"><span class="pre">-driver</span> <span class="pre">null</span></code> instruct Fluent that it will be running with no GUI to avoid errors caused by plot / figure export.</p></li>
<li><p>The argument <code class="docutils literal notranslate"><span class="pre">-sifile=./&quot;$SLURM_JOBID&quot;_fluent_server_info.txt</span></code> tells Fluent to create a file in the working directory with the remote visualization server info.</p></li>
</ul>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="ch">#!/bin/bash</span>
<span class="c1">#SBATCH --nodes=1</span>
<span class="c1">#SBATCH --ntasks-per-node=1</span>
<span class="c1">#SBATCH --cpus-per-task=4</span>
<span class="c1">#SBATCH --mem=8000</span>
<span class="c1">#SBATCH --job-name=name_fluent_smp_4</span>
<span class="c1">#SBATCH --output=output_fluent_smp_4</span>
<span class="c1">#SBATCH --time=01:00:00</span>
<span class="c1">#SBATCH --mail-user=a.person@sheffield.ac.uk</span>
<span class="c1">#SBATCH --mail-type=ALL</span>
module<span class="w"> </span>load<span class="w"> </span>ANSYS/2023R2

fluent<span class="w"> </span>2ddp<span class="w"> </span>-t<span class="nv">$SLURM_CPUS_PER_TASK</span><span class="w"> </span>-gu<span class="w"> </span>-driver<span class="w"> </span>null<span class="w"> </span>-sifile<span class="o">=</span>./<span class="s2">&quot;</span><span class="nv">$SLURM_JOBID</span><span class="s2">&quot;</span>_fluent_server_info.txt<span class="w"> </span>-i<span class="w"> </span>test.jou
</pre></div>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>You may have noted that this SMP job uses different arguments as the MPI jobs below. The use of a single task is intentional and is in order to ensure all requested memory within a job is available to <strong>all</strong> Fluent application threads
in a single CGroup. This should avoid asymmetric memory requirements for the host Fluent process during start up in some models causing crashes due to insufficient memory being available and the scheduler terminating the job.</p>
</div>
<p>The job is submitted to the queue by typing:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sbatch<span class="w"> </span>cfd_job.sh
</pre></div>
</div>
</section>
<section id="sample-mpi-fluent-scheduler-job-scripts">
<h4>Sample MPI Fluent Scheduler Job Scripts<a class="headerlink" href="#sample-mpi-fluent-scheduler-job-scripts" title="Link to this heading"></a></h4>
<p>As SLURM is capable of making MPI job resource requests very specifically, two scripts are provided below. The first is a <strong>“generic”</strong> job submission with the scheduler allocating MPI tasks
and cores anywhere it can freely find them available in the cluster. The second script is a <strong>“specific”</strong> example with the scheduler being explicitly told to allocate tasks with cores specifically
across 4 nodes.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>In most cases a generic request for cores across the cluster with <code class="docutils literal notranslate"><span class="pre">#SBATCH</span> <span class="pre">--ntasks=n</span></code> is ideal to reduce queue times, (as the scheduler can more freely allocate cores), so the first example should suffice in most cases.</p>
</div>
<p>The following is the <strong>“generic”</strong> batch submission script, <code class="docutils literal notranslate"><span class="pre">cfd_job.sh</span></code>, to run the executable <code class="docutils literal notranslate"><span class="pre">fluent</span></code> with input journal file <code class="docutils literal notranslate"><span class="pre">test.jou</span></code>, and carry out a 2D double precision CFD simulation.
The script requests 4 cores, 1 core per task (the default) with 4 tasks, with a runtime of 60 mins and 2 GB of real memory per core.</p>
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<ul class="simple">
<li><p>The <code class="docutils literal notranslate"><span class="pre">#SBATCH</span> <span class="pre">--ntasks=4</span></code> asks the scheduler for 4 tasks (each with a single core by default) which are allocated on any node across the cluster as no further specific options are supplied.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">srun</span> <span class="pre">hostname</span> <span class="pre">-s</span> <span class="pre">&gt;</span> <span class="pre">hosts.$SLURM_JOB_ID</span></code> section sets up the hostlist which is required for correct MPI task spawning in conjunction with the <code class="docutils literal notranslate"><span class="pre">-cnf=hosts.$SLURM_JOB_ID</span></code> argument.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">2ddp</span></code> argument is used to specify a 2D double precision simulation. Valid values include: <code class="docutils literal notranslate"><span class="pre">2d</span></code>, <code class="docutils literal notranslate"><span class="pre">2ddp</span></code>, <code class="docutils literal notranslate"><span class="pre">3d</span></code> and <code class="docutils literal notranslate"><span class="pre">3ddp</span></code>.</p></li>
<li><p>The argument <code class="docutils literal notranslate"><span class="pre">$SLURM_NTASKS</span></code> is a SLURM scheduler variable which will return the requested number of tasks.</p></li>
<li><p>The argument <code class="docutils literal notranslate"><span class="pre">-mpi=intel</span></code> instructs Fluent to use the Intel MPI communcation method. Consult Fluent documentation for OpenMPI instructions if applicable.</p></li>
<li><p>The argument <code class="docutils literal notranslate"><span class="pre">-scheduler_tight_coupling</span></code>  instructs Fluent to use Slurm to efficiently and safely do task spawning.</p></li>
<li><p>The arguments <code class="docutils literal notranslate"><span class="pre">-gu</span></code> and <code class="docutils literal notranslate"><span class="pre">-driver</span> <span class="pre">null</span></code> instruct Fluent that it will be running with no GUI to avoid errors caused by plot / figure export.</p></li>
<li><p>The argument <code class="docutils literal notranslate"><span class="pre">-pib.infinipath</span></code> instructs Fluent to use the high performance Omnipath networking.</p></li>
<li><p>The argument <code class="docutils literal notranslate"><span class="pre">-sifile=./&quot;$SLURM_JOBID&quot;_fluent_server_info.txt</span></code> tells Fluent to create a file in the working directory with the remote visualization server info.</p></li>
</ul>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="ch">#!/bin/bash</span>
<span class="c1">#SBATCH --mem-per-cpu=2000</span>
<span class="c1">#SBATCH --ntasks=4</span>
<span class="c1">#SBATCH --job-name=name_fluent_mpi_4_generic</span>
<span class="c1">#SBATCH --output=output_fluent_mpi_4_generic</span>
<span class="c1">#SBATCH --time=01:00:00</span>
<span class="c1">#SBATCH --mail-user=a.person@sheffield.ac.uk</span>
<span class="c1">#SBATCH --mail-type=ALL</span>
module<span class="w"> </span>load<span class="w"> </span>ANSYS/2023R2

srun<span class="w"> </span>hostname<span class="w"> </span>-s<span class="w"> </span>&gt;<span class="w"> </span>hosts.<span class="nv">$SLURM_JOB_ID</span>

fluent<span class="w"> </span>2ddp<span class="w"> </span>-t<span class="nv">$SLURM_NTASKS</span><span class="w"> </span>-mpi<span class="o">=</span>intel<span class="w"> </span>-scheduler_tight_coupling<span class="w"> </span>-cnf<span class="o">=</span>hosts.<span class="nv">$SLURM_JOB_ID</span><span class="w"> </span>-gu<span class="w"> </span>-driver<span class="w"> </span>null<span class="w">  </span>-pib.infinipath<span class="w"> </span>-sifile<span class="o">=</span>./<span class="s2">&quot;</span><span class="nv">$SLURM_JOBID</span><span class="s2">&quot;</span>_fluent_server_info.txt<span class="w"> </span>-i<span class="w"> </span>test.jou
</pre></div>
</div>
<p>The following is the <strong>“specific”</strong> batch submission script, <code class="docutils literal notranslate"><span class="pre">cfd_job.sh</span></code>, to run the executable <code class="docutils literal notranslate"><span class="pre">fluent</span></code> with input journal file <code class="docutils literal notranslate"><span class="pre">test.jou</span></code>, and carry out a 2D double precision CFD simulation.
The script requests 4 cores (1 core per task, 1 task per node on 4 nodes) with a runtime of 60 mins and 2 GB of real memory per core.</p>
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<ul class="simple">
<li><p>The <code class="docutils literal notranslate"><span class="pre">#SBATCH</span> <span class="pre">--nodes=4</span></code> asks the scheduler for 4 nodes.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">#SBATCH</span> <span class="pre">--ntasks-per-node=1</span></code> asks the scheduler for 1 task per node.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">#SBATCH</span> <span class="pre">--cpus-per-task=1</span></code> asks the scheduler for 1 core in each task.</p></li>
</ul>
<p>The above combined options taken together instruct the scheduler to allocate the job resources as described above, 1 core per task, 1 task per node on 4 nodes = 4 cores. These options can be combined
together in other ways which may be optimal for certain Fluent models. e.g. some may benefit from higher CPU performance, greater memory bandwidth or other optimised resource requests.</p>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="ch">#!/bin/bash</span>
<span class="c1">#SBATCH --nodes=4</span>
<span class="c1">#SBATCH --ntasks-per-node=1</span>
<span class="c1">#SBATCH --cpus-per-task=1</span>
<span class="c1">#SBATCH --mem-per-cpu=2000</span>
<span class="c1">#SBATCH --job-name=name_fluent_mpi_4_specific</span>
<span class="c1">#SBATCH --output=output_fluent_mpi_4_specific</span>
<span class="c1">#SBATCH --time=01:00:00</span>
<span class="c1">#SBATCH --mail-user=a.person@sheffield.ac.uk</span>
<span class="c1">#SBATCH --mail-type=ALL</span>
module<span class="w"> </span>load<span class="w"> </span>ANSYS/2023R2

srun<span class="w"> </span>hostname<span class="w"> </span>-s<span class="w"> </span>&gt;<span class="w"> </span>hosts.<span class="nv">$SLURM_JOB_ID</span>

fluent<span class="w"> </span>2ddp<span class="w"> </span>-t<span class="nv">$SLURM_NTASKS</span><span class="w"> </span>-mpi<span class="o">=</span>intel<span class="w"> </span>-scheduler_tight_coupling<span class="w"> </span>-cnf<span class="o">=</span>hosts.<span class="nv">$SLURM_JOB_ID</span><span class="w"> </span>-gu<span class="w"> </span>-driver<span class="w"> </span>null<span class="w">  </span>-pib.infinipath<span class="w"> </span>-sifile<span class="o">=</span>./<span class="s2">&quot;</span><span class="nv">$SLURM_JOBID</span><span class="s2">&quot;</span>_fluent_server_info.txt<span class="w"> </span>-i<span class="w"> </span>test.jou
</pre></div>
</div>
<p>Either job can then be submitted to the queue by typing:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sbatch<span class="w"> </span>cfd_job.sh
</pre></div>
</div>
<hr class="docutils" />
<div class="toctree-wrapper compound" id="export-fluent-plots-while-using-batch-jobs">
</div>
</section>
</section>
</section>
<section id="exporting-gui-fluent-plots-in-batch-submission-jobs">
<h2><a class="toc-backref" href="#id7" role="doc-backlink">Exporting GUI Fluent plots in batch submission jobs</a><a class="headerlink" href="#exporting-gui-fluent-plots-in-batch-submission-jobs" title="Link to this heading"></a></h2>
<p>While in a batch job you cannot call a display of a window / figure / animation as Fluent has nowhere to direct this output (there is no available display.)</p>
<p>To avoid this issue while attempting to export images from a batch job you should ensure the fluent command in your submission script has the <code class="docutils literal notranslate"><span class="pre">-gu</span></code> and  <code class="docutils literal notranslate"><span class="pre">-driver</span> <span class="pre">null</span></code> arguments.</p>
<p>for a <strong>Bessemer</strong> batch job:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>fluent<span class="w"> </span>2ddp<span class="w"> </span>-i<span class="w"> </span>test.jou<span class="w"> </span>-gu<span class="w"> </span>-t<span class="nv">$SLURM_NTASKS</span><span class="w"> </span>-driver<span class="w"> </span>null
</pre></div>
</div>
<p>You can setup your plots / graphs either in your journal file or interactively via the GUI and saving the case file.</p>
<p>You can then instruct Fluent to make a hard copy after each figure/animation in the you journal file  with:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/</span><span class="n">display</span><span class="o">/</span><span class="n">hard</span><span class="o">-</span><span class="n">copy</span> <span class="s2">&quot;myfile.tif&quot;</span>
</pre></div>
</div>
<p>Ensure that you select the correct file format as some file types will not support animations.</p>
<hr class="docutils" />
<p>For an example of the journal file commands see below:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/</span><span class="n">display</span> <span class="nb">set</span><span class="o">-</span><span class="n">window</span> <span class="n">xx</span> <span class="p">;(</span><span class="n">xx</span> <span class="o">-&gt;</span> <span class="n">window</span> <span class="n">number</span><span class="p">)</span>
<span class="o">/</span><span class="n">display</span> <span class="nb">set</span> <span class="n">contours</span> <span class="n">surface</span> <span class="n">yy</span> <span class="p">;(</span><span class="n">surface</span> <span class="nb">id</span> <span class="o">=</span> <span class="n">yy</span><span class="p">)</span>
<span class="o">/</span><span class="n">display</span> <span class="nb">set</span> <span class="n">contours</span> <span class="n">filled</span><span class="o">-</span><span class="n">contours</span> <span class="n">yes</span>
<span class="o">/</span><span class="n">display</span> <span class="n">contour</span> <span class="n">zz</span> <span class="n">vof</span> <span class="mi">0</span> <span class="mi">1</span> <span class="p">;(</span><span class="n">contour</span> <span class="n">of</span> <span class="n">volume</span> <span class="n">fraction</span> <span class="n">field</span> <span class="p">(</span><span class="n">vof</span><span class="p">)</span> <span class="n">of</span> <span class="n">zz</span> <span class="n">phase</span><span class="p">,</span> <span class="nb">min</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">max</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="o">/</span><span class="n">display</span> <span class="n">hard</span><span class="o">-</span><span class="n">copy</span> <span class="s2">&quot;vof-%t.jpg&quot;</span> <span class="p">;(</span><span class="n">save</span> <span class="n">the</span> <span class="n">image</span> <span class="n">file</span> <span class="ow">in</span> <span class="o">.</span><span class="n">jpg</span> <span class="nb">format</span><span class="p">)</span>
</pre></div>
</div>
<hr class="docutils" />
<section id="sources">
<h3><a class="toc-backref" href="#id8" role="doc-backlink">Sources</a><a class="headerlink" href="#sources" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://www.researchgate.net/post/How-can-I-export-my-contour-image-for-every-required-time-step-in-Fluent">https://www.researchgate.net/post/How-can-I-export-my-contour-image-for-every-required-time-step-in-Fluent</a></p></li>
<li><p><a class="reference external" href="https://www.eureka.im/273.html">https://www.eureka.im/273.html</a></p></li>
</ul>
</section>
</section>
<hr class="docutils" />
<section id="ansys-fluent-training-and-help-resources">
<h2><a class="toc-backref" href="#id9" role="doc-backlink">ANSYS Fluent training and help resources</a><a class="headerlink" href="#ansys-fluent-training-and-help-resources" title="Link to this heading"></a></h2>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Academic support requests should be directed to the <a class="reference external" href="mailto:research-it&#37;&#52;&#48;sheffield&#46;ac&#46;uk">IT Services’ Research and Innovation team</a>  or
the <a class="reference external" href="https://forum.ansys.com/">ANSYS Learning Forum</a> (<strong>ensure you register with your University email for priority support</strong>).</p>
</div>
<p>ANSYS provides numerous academic training and help resources including tutorials, video lectures and examples for computational fluid dynamics products.
A short list of the resources ANSYS maintains is summarised below:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://www.youtube.com/user/ANSYSHowToVideos/playlists?view=50&amp;sort=dd&amp;shelf_id=3">“How to” youtube playlists for computational fluid dynamics products.</a></p></li>
<li><p><a class="reference external" href="https://courses.ansys.com/index.php/fluids/">An extensive number of free online courses on computational fluid dynamics products and theory</a></p></li>
</ul>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="index.html" class="btn btn-neutral float-left" title="ANSYS" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="mechanical.html" class="btn btn-neutral float-right" title="Mechanical / MAPDL" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, The University of Sheffield.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
<footer class="footer">
  <div class="container">
    <div class="left-footer">
         &copy; 2024, The University of Sheffield
       <a rel="license" href="http://creativecommons.org/licenses/by/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by/4.0/80x15.png" /></a>
    </div>
   
    <div class="centre-footer">
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 7.3.7
    </div>
  </div>
</footer>

</body>
</html>